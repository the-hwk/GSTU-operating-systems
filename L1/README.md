**Операционные системы**
## Лабораторная работа №1 (4 ч)

**Тема:** Основы работы в командной строке Windows (CMD).

**Цель работы:** Освоить базовые команды управления ОС Windows, научиться работать с файловой системой и автоматизировать задачи с помощью сценариев.

### Теоретические сведения и задание

#### Примечание
В заданиях есть **параметры**, которые Вы должны задать и использовать. Параметры следующие:
- `NAME` - Ваша фамилия латиницей (например, `Ivanov`)
- `ID` - последние 3 цифры Вашего студенческого билета (например, `042`)
- `GROUP` - название Вашей группы (`ZIT-21`)

#### Командная строка

Командная строка (*Command Line Interface*, *CLI*) - это программная оболочка, которая позволяет пользователю взаимодействовать с операционной системой через ввод текстовых команд с клавиатуры. 

В отличие от привычного графического интерфейса (*GUI*) с кнопками и окнами, *CLI* работает напрямую с интерпретатором команд, что делает её мощным инструментом в руках профессионала. Она используется прежде всего для **автоматизации** повторяющихся задач, **удаленного администрирования** серверов (где графическая оболочка часто избыточна) и получения доступа к **низкоуровневым функциям** системы, которые часто скрыты в обычном меню. 

Также большинство профессиональных утилит для разработки и развертывания программного обеспечения - от систем контроля версий (*Git*) и менеджеров пакетов (*npm*, *pip*, *NuGet*) до компиляторов и средств контейнеризации (*Docker*) - изначально проектируются для работы через *CLI*. Владение командной строкой отделяет разработчика, умеющего лишь писать код, от инженера, способного полностью управлять жизненным циклом своего приложения.

Для запуска командной строки в ОС *Windows* нажмите сочетание клавиш `Win` + `R`, в появившемся окне "Выполнить" введите `cmd` и нажмите `Enter`.

*Примечание: в командной строке есть автодополнение названий папок и файлов. Для этого введите первые один или несколько символов имени требуемого файла или папки и нажмите на кнопку `Tab`. Если совпадений несколько, то повторным нажатием на кнопку `Tab` можно их перебирать.*
 
#### Навигация и файловая система
Необходимые команды:
- `<tom_name>:` - переход на указанный диск (`<tom_name>` - название диска)
- `сd <path>` (*Change Directory*) - переход по папкам (`<path>` - путь к папке)
-  `cd ..` - переход на уровень выше (на родительскую папку)
- `dir` - просмотр содержимого папки
- `mkdir <name>` - создать папку (`<name>` - название папки)

Задание:
1. Перейдите на любой диск, например, `D` (команда `D:`).
2. Создайте дерево папок: `OS_Labs\GROUP\NAME`.
3. Передите в созданную папку `GROUP` и выведите ее содержимое.

#### Работа с файлами/папками и справкой
Необходимые команды:
- `echo <string> > <filename>` - создать файл с именем `<filename>` и записать в него текст `<string>` (пример: `echo Some string > text.txt`)
- `/?` - вызов справки (например, `dir /?`)
- `type` - чтение файла
- `copy` - копирование файла
- `move` - перемещение или переименовывание файла/папки
	- `move <name> <dir>` - перемещение файла/папки (`<name>` - файл или папка, `dir` - папка, в которую необходимо переместить)
	- `move <old_name> <new_name>` - переименование файла/папки (`<old_name>` - текущее название, `<new_name>` - новое название)
- `del` - удаление файла или папки

Задание:
1. Находясь в папке `NAME`, создайте файл `info.txt`, содержащий Ваш `ID` (пример текста файла: `My ID is 042`).
2. С помощью справки команды `copy` узнайте какой параметр позволяет копировать файлы, проверяя правильность копирования файла.
3. Скопируйте файл `info.txt` в файл `copy_ID.txt`
4. Создайте в папке `NAME` папку `Archive_ID`. Переместите созданный ранее файл `copy_ID.txt` в папку `Archive_ID`.
5. Выведите содержимое папки `NAME` и убедитесь, что файла `copy_ID.txt` там нет.
6. Находясь в папке `NAME`, переименуйте файл `info.txt` в `final_report.txt`.
7. Переименуйте папку `Archive_ID` в `Safe_Storage_ID`.

#### Перенаправление потоков и фильтрация
Необходимые команды и операторы:
- `>` - перенаправление потока вывода (например, при вызове команды `ipconfig` текст из ее потока вывода отобразится в командной строке. Чтобы перенаправить вывод команды `ipconfig` в файл (другими словами, сохранить результат выполнения команды), можно использовать оператор перенаправления потока вывода: `ipconfig > result.txt`)
- `>>` - перенаправление потока вывода, но запись выполняется в конец файла
- `|` - конвейер (передача вывода одной команды другой)
- `findstr` - поиск подстроки

Задание:
1. Находясь в папке `Safe_Storage_ID`, выполните команду `ipconfig`. Посмотрите какой текст выведен в результате выполнения команды.
2. Теперь выполните ту же команду, но вместо вывода на экран, направьте результат в файл `net_NAME_ID.txt`.
3. Добавьте текущую дату в этот же файл: `date /t >> net_NAME_ID.txt`.
4.  Создайте в этой же папке еще 3 файла с любым названием. С помощью конвейера выведите из списка всех файлов только те, где встречается Ваш ID: `dir | findstr "_ID"`.

#### Диагностика системы и управление процессами
Необходимые команды:
- `systeminfo` - вывод полных данных о ПК
- `tasklist` - список процессов
- `taskkill` - закрытие программы (завершение работы процесса)

1. Выведите информацию о системе.
2. Запустите блокнот (`notepad.exe`). В консоли найдите его *PID*: `tasklist | findstr "notepad"`.
3. Завершите работу блокнота через консоль, используя его имя: `taskkill /IM notepad.exe /F`

#### Автоматизация (*Batch*-скрипты)
Файлы с расширением `.bat` позволяют выполнять последовательность команд, перечисленных в этом файле. 

Задание:
1. Создайте в папке `NAME` файл `report.bat`.
2. Откройте его в блокноте (`notepad.exe report.bat`) и напишите следующий код:

```Shell
@echo off
echo Student: %1
echo Date:
date /t
echo Username: %USERNAME%
pause
```

3. Запустите скрипт, передав фамилию как аргумент: `report.bat NAME`.

В этом скрипте `%1` - это первый параметр, который передается скрипту в момент его запуска (в данном случае - это `NAME`). Соответственно, `%2` - это второй параметр, `%3` - третий, и т.д. `$USERNAME$` - это системная переменная, которая хранит имя текущего пользователя системы.

4. Изучите содержимое следующего скрипта:

```Shell
:: Отключаем вывод команд скрипта во время его выполнения
@echo off

:: Присваиваем значения из аргументов командной строки
set NAME=%1
set ID=%2

:: Получаем дату
set CURRENT_DATE=%DATE%

echo Start file generator...

:: Цикл от 1 до 5 с шагом 1
:: %%N - переменная цикла
for /L %%N in (1, 1, 5) do (
    :: Проверка условия: если итерация равна 3
	if %%N==3 (
	    :: То записываем вывод команды tasklist в файл
		tasklist > "%NAME%_%ID%_%%N_%CURRENT_DATE%.txt"
	) else (
		:: Иначе записываем текст с номером итерации в файл
		echo This is file with number %%N > "%NAME%_%ID%_%%N_%CURRENT_DATE%.txt"
	)
)

echo Ready! Opening current folder in explorer...
explorer .
pause
```

Напишите этот скрипт в файл `file_generator.bat`. Выполните этот скрипт, передав ему в качестве параметров `NAME` и `ID`. Опишите суть этого скрипта в отчете.

5. Откройте файл, в котором содержится вывод команды `tasklist`.
6. Удалите сгенерированные файлы с использованием команды `del`. Т.к. сгененированные файлы имеют шаблонное название, то можно передать команде `del` часть названия файла: `del NAME*` (`NAME*` означает, что нужно удалить файлы, название которых начинается с `NAME`).

### Отчет по лабораторной работе должен содержать

1. Цель и задачи работы.
2. Описание каждого пункта задания и скриншот с результатом его выполнения.
3. Вывод по выполненной работе

### Список вопросов на защиту

1. В чем разница между абсолютным и относительным путем к файлу?
2. Что произойдет, если выполнить команду `move` для файла, указав в качестве цели имя, которого не существует в текущей папке?
3. Для чего используется символ «звездочка» (`*`) в именах файлов (например, `del *.txt`)?
4. Как в командной строке объединить две команды так, чтобы вторая выполнилась только в случае успеха первой?
5. Каким образом можно остановить выполнение затянувшегося процесса или зависшего скрипта в консоли?
6. В чем разница между операторами `>` и `>>` при работе с файлами?
7. Что такое «переменные окружения» и приведите пример одной системной переменной?
8. Как внутри `.bat` файла обратиться к первому аргументу, который был передан скрипту при запуске?
9. Зачем в начале большинства `.bat` файлов пишется команда `@echo off`?
10. Как вывести на экран справку по любой команде (например, для команды `dir`)?